<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays & Sliding Window - Master DSA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
        }

        .nav-bar {
            background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-bar a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-bar h1 {
            color: white;
            font-size: 1.5em;
            flex: 1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 1100px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
        }

        .card h2 {
            font-size: 1.5em;
            color: #1a1a2e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 3px solid #0891b2;
            padding-bottom: 10px;
        }

        .card h2 i {
            color: #0891b2;
        }

        .canvas-container {
            background: #f8f8f8;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid #eee;
        }

        canvas {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            align-items: center;
        }

        .btn {
            padding: 12px 20px;
            border: 2px solid transparent;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: #0891b2;
            color: white;
        }

        .btn-primary:hover {
            background: #0e7490;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-secondary {
            background: white;
            color: #1a1a2e;
            border-color: #e0e0e0;
        }

        .btn-secondary:hover {
            border-color: #0891b2;
            color: #0891b2;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-group input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            width: 100px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: #e0e0e0;
            padding: 5px;
            border-radius: 10px;
        }

        .tab {
            flex: 1;
            padding: 10px;
            background: transparent;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #555;
        }

        .tab.active {
            background: #white;
            background: #0891b2;
            color: white;
            shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 8px;
            border: 1px solid #cffafe;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #0891b2;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .step-info {
            background: #0891b2;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: 600;
            margin: 15px 0;
            min-height: 50px;
            display: flex;
            align-items: center;
        }

        /* THEORY SECTION STYLES */
        .theory-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-top: 40px;
        }

        .theory-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .theory-header h2 {
            font-size: 2.2em;
            color: #1a1a2e;
            margin-bottom: 10px;
        }

        .theory-header p {
            color: #666;
            font-size: 1.1em;
            max-width: 600px;
            margin: 0 auto;
        }

        .theory-header::after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background: #0891b2;
            margin: 20px auto 0;
            border-radius: 2px;
        }

        .theory-block {
            margin-bottom: 50px;
        }

        .theory-block h3 {
            font-size: 1.6em;
            color: #0891b2;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theory-block p {
            line-height: 1.7;
            color: #444;
            margin-bottom: 15px;
            font-size: 1.05em;
        }

        .theory-block ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .theory-block li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .theory-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        @media (max-width: 800px) {
            .theory-grid {
                grid-template-columns: 1fr;
            }
        }

        .complexity-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #0891b2;
        }

        .complexity-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 5px;
        }

        .complexity-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .complexity-val {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            color: #e11d48;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            line-height: 1.5;
            border: 1px solid #333;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .keyword {
            color: #569cd6;
        }

        .type {
            color: #4ec9b0;
        }

        .string {
            color: #ce9178;
        }

        .comment {
            color: #6a9955;
        }

        .func {
            color: #dcdcaa;
        }

        .highlight-box {
            background: #ecfeff;
            border: 1px solid #a5f3fc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .highlight-title {
            font-weight: 700;
            color: #0e7490;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>

<body>
    <div class="nav-bar">
        <a href="index.html"><i class="fas fa-home"></i> Home</a>
        <h1><i class="fas fa-th-list"></i> Arrays & Techniques</h1>
        <a href="linked-lists.html">Next: Linked Lists <i class="fas fa-arrow-right"></i></a>
    </div>

    <div class="container">
        <!-- Interactive Section -->
        <div class="main-grid">
            <div class="left-column">
                <div class="card">
                    <h2><i class="fas fa-play"></i> Interactive Visualizer</h2>
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('dynamic')">Dynamic Array</button>
                        <button class="tab" onclick="switchTab('sliding')">Sliding Window</button>
                        <button class="tab" onclick="switchTab('two-pointer')">Two Pointers</button>
                    </div>

                    <div class="canvas-container">
                        <canvas id="mainCanvas" width="800" height="300"></canvas>
                    </div>

                    <!-- Dynamic Array Controls -->
                    <div id="dynamicControls" class="controls">
                        <div class="input-group">
                            <input type="number" id="arrInput" placeholder="Value" value="10">
                            <button class="btn btn-primary" onclick="pushElement()">Push</button>
                        </div>
                        <button class="btn btn-danger" onclick="popElement()">Pop</button>
                        <button class="btn btn-secondary" onclick="resetDynamic()">Reset</button>
                    </div>

                    <!-- Sliding Window Controls -->
                    <div id="slidingControls" class="controls" style="display: none;">
                        <div class="input-group">
                            <input type="number" id="windowSize" placeholder="k" value="3" min="1" max="5">
                            <button class="btn btn-success" onclick="startSlidingWindow()">Find Max Sum</button>
                        </div>
                        <button class="btn btn-secondary" onclick="initSlidingWindow()">New Array</button>
                    </div>

                    <!-- Two Pointers Controls -->
                    <div id="twoPointerControls" class="controls" style="display: none;">
                        <div class="input-group">
                            <input type="number" id="targetSum" placeholder="Target" value="15">
                            <button class="btn btn-warning" onclick="startTwoPointers()">Find Pair Sum</button>
                        </div>
                        <button class="btn btn-secondary" onclick="initTwoPointers()">New Sorted Array</button>
                    </div>

                    <div class="step-info" id="stepInfo">Ready to visualize.</div>

                    <div class="stats-grid" id="arrayStats">
                        <div class="stat-item">
                            <div class="stat-value" id="arrSize">0</div>
                            <div class="stat-label">Size</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="arrCapacity">4</div>
                            <div class="stat-label">Capacity</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="arrAccess">O(1)</div>
                            <div class="stat-label">Access Time</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="right-column">
                <div class="card" id="infoCard">
                    <!-- Dynamic Array Brief -->
                    <div id="dynamicInfo">
                        <h2><i class="fas fa-bolt"></i> Quick Concept</h2>
                        <p><strong>Dynamic Arrays</strong> (like ArrayList, Vector) automatically resize themselves when
                            they run out of space, usually doubling their capacity.</p>
                        <div class="highlight-box">
                            <div class="highlight-title"><i class="fas fa-lightbulb"></i> Key Insight</div>
                            Amortized complexity for insertion is <strong>O(1)</strong>, even though resizing takes O(N)
                            occasionally.
                        </div>
                    </div>

                    <!-- Sliding Window Brief -->
                    <div id="slidingInfo" style="display: none;">
                        <h2><i class="fas fa-bolt"></i> Quick Concept</h2>
                        <p><strong>Sliding Window</strong> converts nested loops O(N²) into a single pass O(N) by
                            maintaining a running window over the data.</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Fixed Size: Max sum of subarray size K.</li>
                            <li>Variable Size: Longest substring without repeats.</li>
                        </ul>
                    </div>

                    <!-- Two Pointers Brief -->
                    <div id="twoPointerInfo" style="display: none;">
                        <h2><i class="fas fa-bolt"></i> Quick Concept</h2>
                        <p><strong>Two Pointers</strong> technique uses two indices to traverse the array, often from
                            ends towards the center, to solve problems in linear time.</p>
                        <div class="highlight-box">
                            <div class="highlight-title"><i class="fas fa-exclamation-circle"></i> Requirement</div>
                            Often requires the array to be <strong>sorted</strong> for optimal use (e.g., Two Sum II).
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comprehensive Theory Section -->
        <div class="theory-section">
            <div class="theory-header">
                <h2>Comprehensive Guide</h2>
                <p>Deep dive into Array data structures and algorithmic techniques.</p>
            </div>

            <!-- Topic 1 -->
            <div class="theory-block" id="theory-dynamic">
                <h3><i class="fas fa-layer-group"></i> Dynamic Arrays</h3>
                <p>Arrays are foundational data structures that store elements in contiguous memory locations. A
                    <strong>Dynamic Array</strong> (known as <code>ArrayList</code> in Java, <code>vector</code> in C++,
                    <code>list</code> in Python) overcomes the fixed-size limitation of standard arrays by automatically
                    resizing itself.</p>

                <div class="theory-grid">
                    <div>
                        <h4>How it Works</h4>
                        <ol style="margin-left: 20px;">
                            <li>Start with an initial capacity (e.g., 10).</li>
                            <li>Add elements until capacity is reached.</li>
                            <li>When full, create a new array with <strong>double</strong> the capacity.</li>
                            <li>Copy all existing elements to the new array.</li>
                            <li>Discard the old array and continue adding.</li>
                        </ol>
                    </div>
                    <div class="complexity-card">
                        <h4>Complexity Analysis</h4>
                        <div class="complexity-item"><span>Access (Get/Set)</span> <span
                                class="complexity-val">O(1)</span></div>
                        <div class="complexity-item"><span>Insert (End)</span> <span class="complexity-val">O(1)*</span>
                        </div>
                        <div class="complexity-item"><span>Insert (Middle)</span> <span
                                class="complexity-val">O(N)</span></div>
                        <div class="complexity-item"><span>Remove (End)</span> <span class="complexity-val">O(1)</span>
                        </div>
                        <div style="font-size: 0.8em; color: #666; margin-top: 5px;">*Amortized time complexity</div>
                    </div>
                </div>

                <h4>Implementation (Java-like Pseudocode)</h4>
                <div class="code-block">
                    <span class="keyword">class</span> <span class="type">DynamicArray</span> {
                    <span class="type">int</span>[] arr;
                    <span class="type">int</span> size;
                    <span class="type">int</span> capacity;

                    <span class="func">add</span>(element) {
                    <span class="keyword">if</span> (size == capacity) {
                    resize(); <span class="comment">// O(N) operation</span>
                    }
                    arr[size] = element; <span class="comment">// O(1) operation</span>
                    size++;
                    }

                    <span class="func">resize</span>() {
                    capacity = capacity * 2;
                    <span class="type">int</span>[] newArr = <span class="keyword">new</span> <span
                        class="type">int</span>[capacity];
                    <span class="keyword">for</span>(i=0; i&lt;size; i++) newArr[i] = arr[i];
                    arr = newArr;
                    }
                    }
                </div>
            </div>

            <hr style="border:0; border-top:1px solid #eee; margin: 40px 0;">

            <!-- Topic 2 -->
            <div class="theory-block" id="theory-sliding">
                <h3><i class="fas fa-window-restore"></i> Sliding Window Technique</h3>
                <p>The <strong>Sliding Window</strong> technique is an optimization method used primarily on arrays and
                    strings. It converts a brute-force nested loop approach (O(N²)) into a linear O(N) scan by "sliding"
                    a window of fixed or variable size over the data.</p>

                <div class="theory-grid">
                    <div>
                        <h4>Types of Windows</h4>
                        <ul>
                            <li><strong>Fixed Size:</strong> The window size <code>k</code> is constant. Find
                                sum/max/avg of every subarray of size k. we simply add the incoming element and subtract
                                the outgoing element.</li>
                            <li><strong>Variable Size:</strong> The window expands or contracts based on conditions.
                                Example: Find the smallest subarray with sum &ge; S.</li>
                        </ul>
                    </div>
                    <div class="highlight-box">
                        <div class="highlight-title"><i class="fas fa-star"></i> Real-World Use Case</div>
                        <p><strong>Network Packet Analysis:</strong> Calculating the moving average of network traffic
                            over the last 'k' seconds to detect anomalies without re-scanning the entire history log.
                        </p>
                    </div>
                </div>
            </div>

            <hr style="border:0; border-top:1px solid #eee; margin: 40px 0;">

            <!-- Topic 3 -->
            <div class="theory-block" id="theory-twopointers">
                <h3><i class="fas fa-arrows-alt-h"></i> Two Pointers Technique</h3>
                <p>This pattern involves using two pointers to iterate through the data structure in a coordinated way.
                    It is most effective on <strong>sorted arrays</strong> or linked lists.</p>

                <div class="theory-grid">
                    <div>
                        <h4>Common Patterns</h4>
                        <ul>
                            <li><strong>Opposite Ends:</strong> One pointer at start, one at end. Used for "Two Sum" in
                                sorted array, or reversing a string.</li>
                            <li><strong>Fast & Slow:</strong> Both start at beginning, one moves faster. Used for cycle
                                detection (Floyd's) or finding the middle of a Linked List.</li>
                            <li><strong>Merge Steps:</strong> Used in Merge Sort to merge two sorted subarrays.</li>
                        </ul>
                    </div>
                    <div class="complexity-card">
                        <h4>Efficiency Gain</h4>
                        <div class="complexity-item"><span>Brute Force Pair Sum</span> <span
                                class="complexity-val">O(N²)</span></div>
                        <div class="complexity-item"><span>Two Pointers Pair Sum</span> <span
                                class="complexity-val">O(N)</span></div>
                        <div class="complexity-item"><span>Space Complexity</span> <span
                                class="complexity-val">O(1)</span></div>
                    </div>
                </div>

                <h4>Two Sum Implementation (Sorted)</h4>
                <div class="code-block">
                    <span class="keyword">function</span> <span class="func">twoSum</span>(arr, target) {
                    <span class="type">int</span> left = 0;
                    <span class="type">int</span> right = arr.length - 1;

                    <span class="keyword">while</span> (left &lt; right) {
                    <span class="type">int</span> sum = arr[left] + arr[right];

                    <span class="keyword">if</span> (sum == target) <span class="keyword">return</span> <span
                        class="keyword">true</span>;
                    <span class="keyword">else</span> <span class="keyword">if</span> (sum &lt; target) left++; <span
                        class="comment">// Need bigger sum</span>
                    <span class="keyword">else</span> right--; <span class="comment">// Need smaller sum</span>
                    }
                    <span class="keyword">return</span> <span class="keyword">false</span>;
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPT SECTION (Unchanged logic, just ensure IDs match) -->
    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        const stepInfo = document.getElementById('stepInfo');

        // State
        let currentTab = 'dynamic';
        let isAnimating = false;

        // Dynamic Array State
        let dynArr = [10, 20];
        let capacity = 4;

        // Sliding Window State
        let slideArr = [2, 1, 5, 1, 3, 2, 9, 7];

        // Two Pointer State
        let tpArr = [1, 3, 4, 6, 8, 9, 11, 14];

        function switchTab(tab) {
            currentTab = tab;
            isAnimating = false;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Toggle Controls
            document.getElementById('dynamicControls').style.display = tab === 'dynamic' ? 'flex' : 'none';
            document.getElementById('slidingControls').style.display = tab === 'sliding' ? 'flex' : 'none';
            document.getElementById('twoPointerControls').style.display = tab === 'two-pointer' ? 'flex' : 'none';

            // Toggle Brief Info
            document.getElementById('dynamicInfo').style.display = tab === 'dynamic' ? 'block' : 'none';
            document.getElementById('slidingInfo').style.display = tab === 'sliding' ? 'block' : 'none';
            document.getElementById('twoPointerInfo').style.display = tab === 'two-pointer' ? 'block' : 'none';

            if (tab === 'dynamic') drawDynamic();
            else if (tab === 'sliding') initSlidingWindow();
            else if (tab === 'two-pointer') initTwoPointers();
        }

        // --- DRAWING HELPERS ---
        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function drawBox(x, y, val, color = '#e0e0e0', label = null, isGhost = false) {
            ctx.fillStyle = color;
            if (isGhost) {
                ctx.strokeStyle = '#ccc';
                ctx.setLineDash([5, 5]);
                ctx.strokeRect(x, y, 50, 50);
                ctx.setLineDash([]);
            } else {
                ctx.fillRect(x, y, 50, 50);
                ctx.strokeStyle = '#333';
                ctx.strokeRect(x, y, 50, 50);
            }

            if (val !== null) {
                ctx.fillStyle = '#1a1a2e';
                ctx.font = 'bold 18px Segoe UI';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(val, x + 25, y + 25);
            }

            if (label) {
                ctx.fillStyle = '#666';
                ctx.font = '12px Segoe UI';
                ctx.fillText(label, x + 25, y + 65);
            }
        }

        // --- DYNAMIC ARRAY LOGIC ---
        function drawDynamic() {
            clearCanvas();
            document.getElementById('arrSize').textContent = dynArr.length;
            document.getElementById('arrCapacity').textContent = capacity;

            const startX = 50;
            const startY = 100;

            for (let i = 0; i < capacity; i++) {
                const val = i < dynArr.length ? dynArr[i] : null;
                // const color = i < dynArr.length ? '#bde0fe' : '#f0f0f0';
                drawBox(startX + i * 60, startY, val, i < dynArr.length ? '#bde0fe' : '#f3f4f6', i, i >= dynArr.length);
            }
        }

        async function pushElement() {
            if (isAnimating) return;
            const val = parseInt(document.getElementById('arrInput').value);

            if (dynArr.length === capacity) {
                stepInfo.textContent = "Capacity reached! Resizing array (Doubling capacity)...";
                isAnimating = true;
                const oldCap = capacity;
                capacity *= 2;
                drawDynamic();
                await sleep(1000);
            }

            dynArr.push(val);
            if (isAnimating) {
                stepInfo.textContent = "Copied elements and added new value.";
                await sleep(500);
            } else {
                stepInfo.textContent = `Pushed ${val}.`;
            }

            isAnimating = false;
            drawDynamic();
        }

        function popElement() {
            if (dynArr.length > 0) {
                const val = dynArr.pop();
                stepInfo.textContent = `Popped ${val}.`;
            } else {
                stepInfo.textContent = "Array is empty.";
            }
            drawDynamic();
        }

        function resetDynamic() {
            dynArr = [10, 20];
            capacity = 4;
            drawDynamic();
            stepInfo.textContent = "Reset to default.";
        }

        // --- SLIDING WINDOW LOGIC ---
        function initSlidingWindow() {
            slideArr = Array.from({ length: 8 }, () => Math.floor(Math.random() * 10) + 1);
            drawSlidingWindow(-1, -1, 0);
        }

        function drawSlidingWindow(start, end, currentSum) {
            clearCanvas();
            const startX = 100;
            const startY = 100;

            slideArr.forEach((val, i) => {
                let color = '#fff';
                if (i >= start && i < end) color = '#a7f3d0';
                drawBox(startX + i * 60, startY, val, color, i);
            });

            if (start !== -1) {
                ctx.beginPath();
                ctx.strokeStyle = '#059669';
                ctx.lineWidth = 3;
                ctx.moveTo(startX + start * 60, startY - 10);
                ctx.lineTo(startX + start * 60, startY - 20);
                ctx.lineTo(startX + (end - 1) * 60 + 50, startY - 20);
                ctx.lineTo(startX + (end - 1) * 60 + 50, startY - 10);
                ctx.stroke();

                ctx.fillStyle = '#059669';
                ctx.font = 'bold 16px Segoe UI';
                ctx.fillText(`Sum: ${currentSum}`, startX + ((start + end - 1) / 2) * 60 + 25, startY - 40);
            }
        }

        async function startSlidingWindow() {
            if (isAnimating) return;
            isAnimating = true;
            const k = parseInt(document.getElementById('windowSize').value);
            let currSum = 0;
            let maxSum = -Infinity;

            stepInfo.textContent = `Building initial window of size ${k}...`;
            for (let i = 0; i < k; i++) {
                currSum += slideArr[i];
                drawSlidingWindow(0, i + 1, currSum);
                await sleep(500);
            }
            maxSum = currSum;
            await sleep(800);

            for (let i = k; i < slideArr.length; i++) {
                stepInfo.textContent = `Sliding: -${slideArr[i - k]} (index ${i - k}) / +${slideArr[i]} (index ${i})`;
                currSum += slideArr[i] - slideArr[i - k];
                maxSum = Math.max(maxSum, currSum);
                drawSlidingWindow(i - k + 1, i + 1, currSum);
                await sleep(1000);
            }

            stepInfo.textContent = `Finished! Max Sum is ${maxSum}`;
            isAnimating = false;
        }

        // --- TWO POINTERS LOGIC ---
        function initTwoPointers() {
            tpArr = [1, 2, 4, 5, 7, 10, 11, 15].sort((a, b) => a - b);
            drawTwoPointers(-1, -1);
        }

        function drawTwoPointers(left, right, found = false) {
            clearCanvas();
            const startX = 100;
            const startY = 100;

            tpArr.forEach((val, i) => {
                let color = '#fff';
                if (i === left || i === right) color = found ? '#a7f3d0' : '#fef08a';
                drawBox(startX + i * 60, startY, val, color, i);
            });

            if (left !== -1) {
                // Left
                ctx.fillStyle = '#d97706';
                ctx.beginPath();
                ctx.moveTo(startX + left * 60 + 25, startY + 60);
                ctx.lineTo(startX + left * 60 + 15, startY + 80);
                ctx.lineTo(startX + left * 60 + 35, startY + 80);
                ctx.fill();
                ctx.fillText("L", startX + left * 60 + 25, startY + 95);

                // Right
                ctx.beginPath();
                ctx.moveTo(startX + right * 60 + 25, startY + 60);
                ctx.lineTo(startX + right * 60 + 15, startY + 80);
                ctx.lineTo(startX + right * 60 + 35, startY + 80);
                ctx.fill();
                ctx.fillText("R", startX + right * 60 + 25, startY + 95);
            }
        }

        async function startTwoPointers() {
            if (isAnimating) return;
            isAnimating = true;
            const target = parseInt(document.getElementById('targetSum').value);
            let left = 0;
            let right = tpArr.length - 1;
            let found = false;

            while (left < right) {
                drawTwoPointers(left, right);
                const sum = tpArr[left] + tpArr[right];
                stepInfo.textContent = `Sum: ${sum} (Target: ${target})`;
                await sleep(1000);

                if (sum === target) {
                    stepInfo.textContent = `Found pair! indices ${left} and ${right}`;
                    drawTwoPointers(left, right, true);
                    found = true;
                    break;
                } else if (sum < target) {
                    left++;
                } else {
                    right--;
                }
            }

            if (!found) stepInfo.textContent = "No pair found.";
            isAnimating = false;
        }

        function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
        drawDynamic();
    </script>
</body>

</html>